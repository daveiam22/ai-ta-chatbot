<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADV 332D Course Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #bf5700 0%, #005f86 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .chat-container {
            width: min(500px, 100%);
            height: 700px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.15);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .chat-header {
            background: linear-gradient(90deg, #bf5700 0%, #005f86 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .chat-header h1 {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .chat-header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .settings-btn {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            width: 35px;
            height: 35px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .settings-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .settings-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            width: min(400px, 90%);
            max-height: 80vh;
            overflow-y: auto;
        }

        .settings-content h3 {
            color: #bf5700;
            margin-bottom: 20px;
        }

        .settings-content label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .settings-content input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            margin-bottom: 15px;
            font-family: monospace;
        }

        .settings-content button {
            background: #bf5700;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            margin-right: 10px;
        }

        .status-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            margin-left: 10px;
        }

        .status-connected { background: #28a745; }
        .status-error { background: #dc3545; }
        .status-disconnected { background: #6c757d; }

        .quick-buttons {
            padding: 15px;
            background: #f8f9fa;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            border-bottom: 1px solid #e9ecef;
        }

        .quick-btn {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 20px;
            padding: 8px 12px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.2s;
            color: #495057;
        }

        .quick-btn:hover {
            background: #bf5700;
            color: white;
            transform: translateY(-1px);
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .message {
            max-width: 85%;
            padding: 12px 16px;
            border-radius: 18px;
            word-wrap: break-word;
            animation: slideIn 0.3s ease-out;
            line-height: 1.4;
        }

        .user-message {
            background: linear-gradient(90deg, #bf5700 0%, #005f86 100%);
            color: white;
            align-self: flex-end;
            border-bottom-right-radius: 4px;
        }

        .bot-message {
            background: #f1f3f5;
            color: #333;
            align-self: flex-start;
            border-bottom-left-radius: 4px;
        }

        .bot-message ul, .bot-message ol {
            margin: 10px 0;
            padding-left: 20px;
        }

        .bot-message li {
            margin: 5px 0;
        }

        .typing-indicator {
            display: none;
            align-self: flex-start;
            background: #f1f3f5;
            padding: 16px;
            border-radius: 18px;
            border-bottom-left-radius: 4px;
        }

        .typing-dots {
            display: flex;
            gap: 4px;
        }

        .typing-dots span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #999;
            animation: typing 1.4s infinite ease-in-out;
        }

        .typing-dots span:nth-child(1) { animation-delay: -0.32s; }
        .typing-dots span:nth-child(2) { animation-delay: -0.16s; }

        .chat-input-container {
            padding: 20px;
            background: #f8f9fa;
            display: flex;
            gap: 10px;
        }

        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e9ecef;
            border-radius: 25px;
            outline: none;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .chat-input:focus {
            border-color: #bf5700;
        }

        .send-button {
            background: linear-gradient(90deg, #bf5700 0%, #005f86 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease;
        }

        .send-button:hover {
            transform: scale(1.05);
        }

        .send-button:active {
            transform: scale(0.95);
        }

        .send-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            padding: 10px 15px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 14px;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes typing {
            0%, 80%, 100% {
                transform: scale(0);
            }
            40% {
                transform: scale(1);
            }
        }

        .chat-messages::-webkit-scrollbar {
            width: 6px;
        }

        .chat-messages::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .chat-messages::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 4px;
            border-radius: 3px;
        }

        .link {
            color: #bf5700;
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="chat-container">
        <div class="chat-header">
            <button class="settings-btn" onclick="openSettings()">‚öôÔ∏è</button>
            <h1>ü§ñ ADV 332D Course Assistant</h1>
            <p>Entrepreneurship in the Age of AI | Prof. Neff | Fall 2025</p>
            <span class="status-indicator status-disconnected" id="statusIndicator"></span>
        </div>
        
        <div class="quick-buttons">
            <button class="quick-btn" onclick="askQuestion('What are the assignment due dates?')">Due Dates</button>
            <button class="quick-btn" onclick="askQuestion('Tell me about the Lean Canvas')">Lean Canvas</button>
            <button class="quick-btn" onclick="askQuestion('Who are the guest speakers?')">Speakers</button>
            <button class="quick-btn" onclick="askQuestion('How is the final pitch graded?')">Final Pitch</button>
            <button class="quick-btn" onclick="askQuestion('What AI tools should I use?')">AI Tools</button>
            <button class="quick-btn" onclick="askQuestion('Office hours info')">Office Hours</button>
        </div>

        <div class="chat-messages" id="chatMessages">
            <div class="message bot-message">
                ü§ò Hook 'em Horns! I'm your AI-powered ADV 332D course assistant, ready to help with your Energy Transition startup journey! Ask me about assignments, guest speakers, the Lean Canvas, AI tools, or anything else about the course.
            </div>
        </div>
        
        <div class="typing-indicator" id="typingIndicator">
            <div class="typing-dots">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
        
        <div class="chat-input-container">
            <input type="text" class="chat-input" id="chatInput" placeholder="Ask about the course..." autocomplete="off">
            <button class="send-button" id="sendButton">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <line x1="22" y1="2" x2="11" y2="13"></line>
                    <polygon points="22,2 15,22 11,13 2,9"></polygon>
                </svg>
            </button>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-content">
            <h3>‚öôÔ∏è AI Configuration</h3>
            <label for="apiKey">Anthropic API Key:</label>
            <input type="password" id="apiKey" placeholder="sk-ant-api03-...">
            <p style="font-size: 12px; color: #6c757d; margin-bottom: 15px;">
                Your API key is stored locally and never sent to external servers except Anthropic's API.
            </p>
            <button onclick="saveSettings()">Save Settings</button>
            <button onclick="closeSettings()" style="background: #6c757d;">Cancel</button>
            <button onclick="testConnection()" style="background: #28a745;">Test Connection</button>
        </div>
    </div>

    <script>
        class CourseBot {
            constructor() {
                this.chatMessages = document.getElementById('chatMessages');
                this.chatInput = document.getElementById('chatInput');
                this.sendButton = document.getElementById('sendButton');
                this.typingIndicator = document.getElementById('typingIndicator');
                this.statusIndicator = document.getElementById('statusIndicator');
                
                this.apiKey = localStorage.getItem('anthropic_api_key') || '';
                this.updateConnectionStatus();
                
                this.courseData = {
                    instructor: {
                        name: "David J. Neff",
                        pronouns: "He/Him",
                        email: "dneff22@Gmail.com",
                        office: "Virtual",
                        officeHours: "TBD"
                    },
                    aiTAs: [
                        { name: "AI Reid Hoffman", url: "https://v0-reid-hoffman-chat-bot.vercel.app/" },
                        { name: "AI Aileen Lee", url: "https://v0-aileen-lee-chatbot.vercel.app/" }
                    ],
                    grading: {
                        "Completion of Activities": "25%",
                        "Two pop quizzes": "12.5% each",
                        "Two Self and Team Reflection Exercises": "12.5% each",
                        "Final pitch and participation": "25%"
                    },
                    learningOutcomes: [
                        "Develop and validate a startup concept focused on the energy transition sector",
                        "Apply AI tools and technologies strategically to enhance entrepreneurial ventures",
                        "Demonstrate proficiency in customer discovery and interviews",
                        "Analyze market opportunities in the energy transition space (TAM, SAM, SOM)",
                        "Develop and deliver a compelling investor pitch to industry professionals"
                    ],
                    books: [
                        "IGNITE: Setting your Culture on Fire",
                        "The Freelancer's Bible: Everything You Need to Know to Have the Career of Your Dreams‚ÄïOn Your Terms"
                    ],
                    schedule: {
                        "Aug 27": "Introductions, team formation, climate startup ideas",
                        "Sep 3": "John Schwartz - Climate 101, team formation",
                        "Sep 10": "Dr. Jeff Stoike - Energy Transition Tech, Lean Canvas creation",
                        "Sep 17": "Tarun Thummala - AI integration, Pop Quiz",
                        "Sep 24": "Dr. Rawand Rasheed - Helix Earth (AI and Climate), Lean Canvas presentations",
                        "Oct 1": "Chelle Neff - Entrepreneurship, Ideal Customer Profiles",
                        "Oct 8": "Bob Fonseca - Entrepreneurship, Pop Quiz, ICP presentations",
                        "Oct 15": "Beatriz Chahin - Market sizing (TAM, SAM, SOM), Mid-term evaluations",
                        "Oct 22": "Dr. Steven Gray - FAST Goals methodology",
                        "Oct 29": "AI Tools lecture, pitch deck development",
                        "Nov 5": "Brian Cahak & Corey Pudhorodsky - Sales, outreach strategies",
                        "Nov 12": "Lizzie Pritchett & Kathleen Mably - Marketing strategies",
                        "Nov 19": "Lu Yan & Hallie Spurlin - Finance and VC 101, Short Exam",
                        "Nov 26": "Thanksgiving Break - No Class",
                        "Dec 3": "Final Exam: Team Pitches to panel of judges"
                    },
                    latePenalties: {
                        "1 day": "10% deduction",
                        "2 days": "20% deduction",
                        "3 days": "30% deduction",
                        "4 days": "40% deduction",
                        "5 days": "50% deduction"
                    },
                    aiTools: [
                        "Perplexity AI for market research",
                        "Hugging Face Spaces for data analysis",
                        "Elicit for literature review",
                        "Canva for pitch deck creation",
                        "Beautiful.ai for presentations"
                    ]
                };

                this.setupEventListeners();
            }

            setupEventListeners() {
                this.sendButton.addEventListener('click', () => this.sendMessage());
                this.chatInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        this.sendMessage();
                    }
                });
            }

            updateConnectionStatus() {
                const hasKey = this.apiKey && this.apiKey.length > 0;
                this.statusIndicator.className = `status-indicator ${hasKey ? 'status-connected' : 'status-disconnected'}`;
            }

            async sendMessage(predefinedMessage = null) {
                const message = predefinedMessage || this.chatInput.value.trim();
                if (!message) return;

                this.addMessage(message, 'user');
                if (!predefinedMessage) {
                    this.chatInput.value = '';
                }
                
                this.showTypingIndicator();
                this.sendButton.disabled = true;

                try {
                    let response;
                    if (this.apiKey) {
                        response = await this.getAIResponse(message);
                    } else {
                        response = this.getFallbackResponse(message);
                    }
                    
                    this.hideTypingIndicator();
                    this.addMessage(response, 'bot');
                } catch (error) {
                    this.hideTypingIndicator();
                    this.addMessage(`I apologize, but I'm having trouble connecting to my AI service. Please try again or check your API key configuration. Error: ${error.message}`, 'bot');
                    this.statusIndicator.className = 'status-indicator status-error';
                } finally {
                    this.sendButton.disabled = false;
                }
            }

            async getAIResponse(userMessage) {
                const systemPrompt = `You are an AI teaching assistant for ADV 332D: Entrepreneurship in the Age of AI at the University of Texas at Austin. You help students with course-related questions using the provided course information.

Course Information:
${JSON.stringify(this.courseData, null, 2)}

Guidelines:
- Be helpful, friendly, and enthusiastic about the course
- Use UT terminology and references where appropriate (Hook 'em Horns, etc.)
- Focus on the energy transition and AI themes of the course
- Provide specific, actionable information when possible
- If asked about something not in the course data, be honest about limitations
- Use emojis and formatting to make responses engaging
- Encourage student success and participation

Always respond as if you're a knowledgeable TA who cares about student success.`;

                const response = await fetch('https://api.anthropic.com/v1/messages', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'x-api-key': this.apiKey,
                        'anthropic-version': '2023-06-01'
                    },
                    body: JSON.stringify({
                        model: 'claude-3-sonnet-20240229',
                        max_tokens: 1000,
                        messages: [{
                            role: 'user',
                            content: userMessage
                        }],
                        system: systemPrompt
                    })
                });

                if (!response.ok) {
                    throw new Error(`API request failed: ${response.status}`);
                }

                const data = await response.json();
                return data.content[0].text;
            }

            getFallbackResponse(message) {
                return `ü§ñ I'd love to give you a more personalized response! To unlock my full AI capabilities, please add your Anthropic API key in the settings (‚öôÔ∏è button in the top right). 

For now, here's some basic help: I can assist with questions about ADV 332D course content, assignments, guest speakers, the Lean Canvas, AI tools, and your energy transition startup ideas. What specifically would you like to know about the course?`;
            }

            addMessage(text, sender) {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${sender}-message`;
                messageDiv.innerHTML = text;
                
                this.chatMessages.appendChild(messageDiv);
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }

            showTypingIndicator() {
                this.typingIndicator.style.display = 'block';
                this.chatMessages.scrollTop = this.chatMessages.scrollHeight;
            }

            hideTypingIndicator() {
                this.typingIndicator.style.display = 'none';
            }

            setApiKey(key) {
                this.apiKey = key;
                localStorage.setItem('anthropic_api_key', key);
                this.updateConnectionStatus();
            }

            async testConnection() {
                if (!this.apiKey) {
                    alert('Please enter an API key first.');
                    return;
                }

                try {
                    const response = await fetch('https://api.anthropic.com/v1/messages', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'x-api-key': this.apiKey,
                            'anthropic-version': '2023-06-01'
                        },
                        body: JSON.stringify({
                            model: 'claude-3-sonnet-20240229',
                            max_tokens: 10,
                            messages: [{
                                role: 'user',
                                content: 'Hello'
                            }]
                        })
                    });

                    if (response.ok) {
                        alert('‚úÖ Connection successful! Your API key is working.');
                        this.statusIndicator.className = 'status-indicator status-connected';
                    } else {
                        throw new Error(`API request failed: ${response.status}`);
                    }
                } catch (error) {
                    alert(`‚ùå Connection failed: ${error.message}`);
                    this.statusIndicator.className = 'status-indicator status-error';
                }
            }
        }

        // Global functions for UI interactions
        function openSettings() {
            document.getElementById('settingsModal').style.display = 'flex';
            document.getElementById('apiKey').value = window.courseBot.apiKey;
        }

        function closeSettings() {
            document.getElementById('settingsModal').style.display = 'none';
        }

        function saveSettings() {
            const apiKey = document.getElementById('apiKey').value.trim();
            window.courseBot.setApiKey(apiKey);
            closeSettings();
            
            if (apiKey) {
                window.courseBot.addMessage('üéâ API key saved! I can now provide more intelligent and personalized responses. Try asking me something!', 'bot');
            }
        }

        function testConnection() {
            const apiKey = document.getElementById('apiKey').value.trim();
            if (apiKey !== window.courseBot.apiKey) {
                window.courseBot.setApiKey(apiKey);
            }
            window.courseBot.testConnection();
        }

        function askQuestion(question) {
            window.courseBot.sendMessage(question);
        }

        // Initialize the chatbot when the page loads
        window.addEventListener('DOMContentLoaded', () => {
            window.courseBot = new CourseBot();
        });
    </script>
</body>
</html>